\documentclass {article}
\usepackage{mathpartir}
\usepackage{cite}
\usepackage{graphicx}
\usepackage{amsmath,fullpage,amssymb}

\newcommand{\typeexample}[2]{$#1$\\$#2$}
\newcommand{\st}{\ensuremath{\hspace{-1px}<:\hspace{-1px}}}
\newcommand{\alphahat}{\hat{\alpha}}
\newcommand{\betahat}{\hat{\beta}}

\newcommand{\botbound}{\sigma_{l}}
\newcommand{\topbound}{\sigma_{u}}

\newcommand{\marker}[1]{{\scriptscriptstyle {\blacktriangleright #1}}}

\newcommand{\lub}{\ensuremath{\vee}}
\newcommand{\glb}{\ensuremath{\wedge}}

\newcommand{\siglub}{\underbar{\lub}}
\newcommand{\sigglb}{\overset{\sigma}{\glb}}


\newcommand{\instr}{\overset{<}{=:}}
\newcommand{\instl}{\overset{<}{:=}}

\newcommand{\bndr}{\instr}
\newcommand{\bndl}{\instl}

\newcommand{\sigbndl}{:<\hspace{-5px}<}
\newcommand{\sigbndr}{<\hspace{-5px}<:}

\newcommand{\siginstr}{\overset{\overline{<}}{=:}}
\newcommand{\siginstl}{\overset{\overline{<}}{:=}}

\newcommand{\ctxtsep}{;}
\newcommand{\ctxbsep}{;}

\newcommand{\tst}{{\scriptstyle{<:}}}
\newcommand{\bound}[3]{#1 \tst #2 \tst #3}

\newcommand{\analyzes}{\ensuremath{\Leftarrow}}
\newcommand{\synth}{\ensuremath{\Rightarrow}}

\newcommand{\fnSynth}{\synth\hspace{-5px}\synth}

\newcommand{\pronounce}[2]{{\makebox[\linewidth][l]{\framebox{#1} \parbox{\textwidth}{#2}}}}

\renewcommand{\and}{\text{ and }}
\newcommand{\ctxmapto}{\longmapsto}


\begin{document}

\section{Instantiation Completeness}
Bound extension:
\[
\inferrule{\Gamma \vdash \sigma_l \sigbndl \tau \dashv \Theta \\ \Gamma \vdash \tau \sigbndr \sigma_t \dashv \Theta' \\ \Theta \ctxmapto \Omega \\ \Theta' \ctxmapto \Omega}{\Gamma, \bound{\sigma_l}{\alphahat}{\sigma_t} \ctxmapto \Omega, \alphahat = \tau} 
\]


Given that $\Gamma \longmapsto \Omega$, $A=[\Gamma]A$, $\alphahat\not\in \text{FV}(A)$\\
if $[\Omega]\Gamma\vdash [\Omega]\alphahat \leq [\Omega]A$, then there are some $\Delta,\Omega'$ such that $\Delta \longmapsto \Omega'$, $\Omega \longrightarrow \Omega'$ and $\Gamma \vdash \alphahat \instl A \dashv \Delta$.\\
if $[\Omega]\Gamma\vdash [\Omega]A \leq [\Omega]\alphahat$, then there are some $\Delta,\Omega'$ such that $\Delta \longmapsto \Omega'$, $\Omega \longrightarrow \Omega'$ and $\Gamma \vdash A \instr \alphahat \dashv \Delta$.

\begin{tabbing}
Case \=$A = 1$\\
\>$A = 1 \implies \Gamma \vdash [\Omega]\alphahat \leq 1$\\
\>$[\Omega]\alphahat = 1$ \` $\Omega$ predicative and by inversion of rule $\st$Unit.\\
\>Want to find $\Delta$ such that $\Gamma \vdash \alphahat \instl 1 \dashv \Delta$\\
\>$\Gamma \vdash \sigma_l \sigbndl 1 \dashv \Theta$ \` As $\Gamma \ctxmapto \Omega\and [\Omega]\alphahat = 1$\\
\> WTS: $\Theta[\alphahat\st\sigma_u] \vdash \sigma_u \lub 1 = 1 \dashv \Theta_f$\\
\>Case \=on $\sigma_u$\\
\>\>Case \=$\sigma_u = \rho;\tau_u$\\
\>\>\>$\Theta\vdash [\Omega]\alphahat \instr \sigma_u \dashv\Theta'$ \` $\Theta \ctxmapto \Omega$, n.t. by Lem. 4 $\Theta'\ctxmapto\Omega$\\
\>\>\>$\Theta\vdash [\Omega]\alphahat \sigbndr \ldots;\tau_u \dashv \Theta'$ \` Case analysis\\
\>\>\>$\Theta''\vdash[\Omega]\alphahat\st\tau_u \dashv\Theta'$ \` By lemma 7\\
\>\>\>$\Theta''\vdash1 \st \tau_u \dashv\Theta'$ \` As $[\Omega]\alphahat = 1$\\
\>\>\>$\tau_u = 1$ \` As $\tau_u$ a monotype and by inversion of rule  $\st$Unit.\\
\>\>\>$\Theta \vdash \sigma_u \lub 1 = \rho;1\dashv\Theta$ \` As $\tau_u = 1$ and by defn. of $\lub$\\
\>\>Case \=$\sigma_u = \rho;\top$\\
\>\>\>$\Theta[\alphahat \st \sigma_u] \vdash \top \lub 1 = \rho;1 \dashv \Theta$ \` By defn. of $\lub$ and case analysis.\\
\>\>Case \=$\sigma_u = \ldots;\bot$\\
\>\>\>$\Theta'' \vdash [\Omega]\alphahat \sigbndr \ldots;\bot \dashv\Theta'$\\
\>\>\>$\Theta''\vdash [\Omega]\alphahat \sigbndr \bot \dashv \Theta'$\\
\>\>\>Contradiction\\
\> $\Gamma \vdash \sigma_l \sigbndl 1 \dashv \Theta \and \Theta \dashv \sigma_u \lub [\Omega]\alphahat = 1 \dashv\Theta$\\
\> $\Gamma \vdash \sigma_l \vee 1 = \sigma_l'$ where $\sigma_l' = \rho;1$ \` (By above case analysis).\\
\>$\Gamma[\bound{\sigma_l}{\alphahat}{\sigma_t}]\vdash \alphahat \instl 1 \dashv \Theta[\alphahat \st \sigma_u']$ \` By InstLAbs\\
\>Let $\Delta = \Theta[\alphahat \st \sigma_u']$\\
\>Let $\Omega' = \Omega$\\
\> $\Omega \longrightarrow \Omega'$ \` By Dunfield Lem. 20 (reflexivity).\\
\> WTS: $\Delta \ctxmapto \Omega$\\
\> $\Theta \ctxmapto \Omega$ \` By Lem. 4\\
\> $\Theta = \Theta_u,\bound{\sigma_b}{\alphahat}{\sigma_u},\Theta_l$ 	\` By defn. of $\Theta$\\
\> $\Delta = \Theta_u,\bound{\sigma_b}{\alphahat}{\sigma_u'},\Theta_l$ 	\` By defn. of $\Delta$\\
\> $\Omega = \Omega_u,\alphahat = 1,\Omega_l$							\` By defn. of $\Omega$ and $\Omega[\alphahat]=1$\\
\> $\Theta_l \ctxmapto \Omega_l$ 										\` Lem. 10\\
\> $\Theta_u \vdash \sigma_b \sigbndl 1 \dashv \Theta_u'$ 				\` Lem. 10\\
\> $\Theta_u \vdash 1 \sigbndr \sigma_u \dashv \Theta_u''$ 				\` Lem. 10\\
\> $\Theta_u''\ctxmapto\Delta$ 											\` Lem. 10\\
\> $\Theta_u'\ctxmapto\Delta$ 											\` Lem. 10\\
\> WTS: $\Theta_u \vdash 1 \sigbndr \sigma_u' \dashv \Theta_u''$\\
\> $\sigma_u' = \rho,1$ 												\` By previous case analysis on $\sigma_u$\\\
\> $\Theta_u'' \vdash 1 \st 1 \dashv \Theta_u''$ 						\` by $\st$Unit\\
\> $\Theta_u \vdash 1 \sigbndr \rho,\top \dashv\Theta_u''$				\` By Lem. 14\\
\> $\Theta_u \vdash 1 \sigbndr \sigma_u' \dashv \Theta_u''$ 			\` By Lem. 12\\
Case \=$A = \betahat$\\
\>$\alphahat \neq \betahat$ 											\` $\alphahat \not\in FV(A)$\\
\> $\Gamma \vdash [\Omega]\alphahat \leq [\Omega]\betahat$ 				\` $A = \betahat$\\
\> $[\Omega]\alphahat = \tau_1$ 										\` $\Omega$ predicative\\
\> $[\Omega]\betahat = \tau_2$ 											\` $\Omega$ predicative\\
\> $\Gamma \vdash \tau_1 \leq \tau_2$ 									\` $\Omega$ predicative and $\Gamma \vdash [\Omega]\alphahat \leq [\Omega]\betahat$\\
\> Let $\Omega' = \Omega$\\
\> $\Omega' \longrightarrow \Omega$ 									\` Dunfield Lem. 20, reflexivity.\\
\> Case \=on $\alphahat$ left or right of $\betahat$\\
\>\>Case \=$\Gamma = (\Gamma_0,\alphahat,\Gamma_1,\bound{\sigma_l}{\betahat}{\sigma_t},\Gamma_2)$\\
\>\>\>$\Gamma_0,\alphahat,\Gamma_1 \vdash \tau_2 \sigbndr \sigma_t$		\` $\Gamma \mapsto \Omega$\\
\>\>\>$\Gamma_0,\alphahat,\Gamma_1 \vdash \tau_1 \sigbndr \sigma_t$		\` Lem. 8, $\Gamma \vdash \tau_1 \leq \tau_2$\\
\>\>\>$\Gamma_0,\alphahat,\Gamma_1 \vdash \alphahat \siginstr \sigma_t \dashv \Theta$	\` Lem. 1\\
\>\>\>$\Gamma_0,\alphahat,\Gamma_1,\betahat,\Gamma_2 \vdash \alphahat \siginstr \sigma_t \dashv \Theta,\bound{\sigma_l;\alphahat}{\betahat}{\sigma_t},\Gamma_2$	\` Lem. 9\\
\>\>\>$\Gamma_0,\alphahat,\Gamma_1,\betahat,\Gamma_2 \vdash \alphahat \instl \betahat \dashv \Theta,\bound{\sigma_l;\alphahat}{\betahat}{\sigma_t},\Gamma_2$	\` InstLReach\\
\>\>\>$\Omega' = \Omega, \Delta = \Theta;\bound{\sigma_l;\alphahat}{\betahat}{\sigma_t};\Gamma_2$\\
\>\>\>WTS: $\Theta,\bound{\sigma_l;\alphahat}{\betahat}{\sigma_t},\Gamma_2 \ctxmapto \Omega_1,\betahat=\tau_2,\Omega_2$\\
\>\>\>$\Theta = \Theta_1,\bound{\sigma_l}{\betahat}{\sigma_t},\Theta_2$ \` Defn. of $\Theta$\\
\>\>\>$\Theta_1,\bound{\sigma_l}{\betahat}{\sigma_t},\Theta_2 \ctxmapto \Omega_1,\betahat = \tau_2,\Omega_2$ \` As $\Theta \ctxmapto \Omega$\\
\>\>\> $\Theta_2 \ctxmapto \Omega_2$ 										\` Lem. 10\\
\>\>\> $\Theta_1 \vdash \sigma_l \sigbndl \tau_2 \dashv \Theta_1'$ 			\` Lem. 10\\
\>\>\> $\Theta_1 \vdash \tau_2 \sigbndr \sigma_t \dashv \Theta_1''$ 		\` Lem. 10\\
\>\>\> $\Theta_1''\ctxmapto\Omega$ 											\` Lem. 10\\
\>\>\> $\Theta_1'\ctxmapto\Omega$ 											\` Lem. 10\\
\>\>\> WTS: $\Theta_1 \vdash \alphahat;\sigma_l \sigbndl \tau_2 \vdash \Theta_f$ and $\Theta_f \ctxmapto \Omega$\\
\>\>\> $\Theta_1 \vdash \sigma_l \sigbndl \tau_2 \dashv \Theta_1'$ 	\` $\Theta_1 \ctxmapto \Omega$\\
\>\>\> $\Theta_1' \vdash [\Omega]\alphahat \leq \tau_2$ 			\` As $\Theta_1',\betahat \ctxmapto \Omega$ and  $\Omega \vdash \alphahat \leq \tau_2$\\
\>\>\> $\Theta_1' \vdash \alphahat \instl \tau_2 \dashv \Theta_{f}$ 			\` By IH.\\
\>\>\> $\Theta_f \ctxmapto \Omega$												\` By IH.\\
\>\>\> $\Theta_1 \vdash \alphahat;\sigma_l \sigbndl \tau_2 \vdash \Theta_f$		\` By definition of $\sigbndl$\\
\>\>\> $\Theta,\bound{\sigma_l;\alphahat}{\betahat}{\sigma_2},\Gamma_2 \ctxmapto \Omega_1,\betahat=\tau_2,\Omega_2$ \` By Lem. 11\\
\>\>Case \=$\Gamma = (\Gamma_0;\bound{\sigma_l}{\betahat}{\sigma_t};\Gamma_1;\alphahat;\Gamma_2)$\\
\end{tabbing}
\end{document}
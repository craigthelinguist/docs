\begin{figure*}[htb!]
\begin{flushleft}\fbox{$\vdash\Theta$}\end{flushleft}
\begin{center}
\AXC{}      \RightLabel{~~~(Th-empty)}
\UIC{$\vdash \emptyset$}
\AXC{$\vdash\Theta$ ~~~~ $T\notin dom(\Theta)$ ~~~~ $\vdash_{\Theta,T[?,?,?]}\delta~\mathit{ok}$ ~~~~ $\vdash_{\Theta,T[\delta,?,?]}\mu~\mathit{ok}$ ~~~~~ $\vdash_{\Theta;T[\delta,\mu,?]}\zeta~\mathit{ok}$}\RightLabel{~~~(Th-extend)}
\UIC{$\vdash \Theta,T[\delta,\mu,\zeta]$}
\noLine
\BIC{}
\DP
\end{center}

\begin{flushleft}\fbox{$\vdash_{\Theta}\delta~\mathit{ok}$}\end{flushleft}
\begin{center}
\AXC{}      \RightLabel{~~~(def-unknown-ok)}
\UIC{$\vdash_{\Theta}~?~\mathit{ok}$}
\AXC{$\vdash_{\Theta}\tau$}   \RightLabel{~~~(def-type-ok)}
\UIC{$\vdash_{\Theta}\tau~\mathit{ok}$}
\noLine
\BIC{}
\DP
\end{center}

\begin{flushleft}\fbox{$\vdash_{\Theta}\tau$}\end{flushleft}
\begin{center}
\AXC{$\vdash_{\Theta}\omega$}\RightLabel{~~~(Ty-ot)}
\UIC{$\vdash_{\Theta}\mathbf{objtype}[\omega]$}
\AXC{$\vdash_{\Theta}\chi$}\RightLabel{~~~(Ty-ct)}
\UIC{$\vdash_{\Theta}\mathbf{casetype}[\chi]$}
\AXC{$\vdash_{\Theta}\tau_1$ ~~~~ $\vdash_{\Theta}\tau_2$}  \RightLabel{~~~(Ty-arrow)}
\UIC{$\vdash_{\Theta}\mathbf{arrow}[\tau_1, \tau_2]$} 
\AXC{$T[\tau,\mu,\zeta]\in\Theta$}\RightLabel{~~~(Ty-named)}
\UIC{$\vdash_{\Theta}\mathbf{named}[T]$}
\noLine
\QIC{}
\DP
\end{center}

\begin{flushleft}\fbox{$\vdash_{\Theta}\mu~\mathit{ok}$}\end{flushleft}
\begin{center}
\AXC{}      \RightLabel{~~~(metadata-unknown)}
\UIC{$\vdash_{\Theta}~?~\mathit{ok}$}
\AXC{$\emptyset\vdash_{\Theta} i\Leftarrow \tau$}\RightLabel{~~~(metadata)}
\UIC{$\vdash_{\Theta}i:\tau~\mathit{ok}$}
\noLine
\BIC{}
\DP
\end{center}

\begin{flushleft}\fbox{$\vdash_{\Theta}\Gamma$}\end{flushleft}
\begin{center}
\AXC{}      \RightLabel{~~~(G-empty)}
\UIC{$\vdash_{\Theta} \emptyset$}
\AXC{$\vdash_{\Theta} \tau$}\RightLabel{~~~(G-extend)}
\UIC{$\vdash_{\Theta}\Gamma,x:\tau$}
\noLine
\BIC{}
\DP
\end{center}

\begin{flushleft}\fbox{$\vdash_{\Theta}\omega$}\end{flushleft}
\begin{center}
\AXC{$\mathit{l}\notin dom(\omega)$ ~~~~ $\vdash_{\Theta}\tau$ ~~~~ $\vdash_{\Theta}\omega$}    \RightLabel{~~~(M-decl)}
\UIC{$\vdash_{\Theta}\mathit{l}[\tau];\omega$}
\DP
\end{center}

\begin{flushleft}\fbox{$\vdash_{\Theta}\chi$}\end{flushleft}
\begin{center}

\AXC{$C\notin dom(\chi)$ ~~~~ $\vdash_{\Theta}\tau$ ~~~~ $\vdash_{\Theta}\chi$}     \RightLabel{~~~(C-decl)}
\UIC{$\vdash_{\Theta}C[\tau];\chi$}
\DP
\end{center}

\begin{flushleft}\fbox{$\vdash_{\Theta}\zeta~\mathit{ok}$}\end{flushleft}
\begin{center}
      \AXC{}      \RightLabel{~~~(kw-unknown)}
      \UIC{$\vdash_{\Theta}~?~\mathit{ok}$}
      \AXC{$\vdash_{\Theta}\gamma$} \RightLabel{~~~(kw-ok)}
      \UIC{$\vdash_{\Theta}\gamma~\mathit{ok}$}
      \noLine
      \BIC{}
      \DP
\end{center}

\begin{flushleft}\fbox{$\vdash_{\Theta}\gamma$}\end{flushleft}
\begin{center}
      \AXC{}      \RightLabel{~~~(kw-empty)}
      \UIC{$\vdash_{\Theta}\emptyset$}
      \AXC{$\Theta_0 \subset \Theta$ ~~~~ $\vdash_{\Theta}\gamma'$ ~~~~ $\vdash_{\Theta}k\notin dom(\gamma') ~~~~ \vdash_{\Theta}e\rightsquigarrow i\Leftarrow Keyword$}
      \UIC{$\vdash_{\Theta} \gamma';k[\mathbf{wk},e]$}
      \noLine
      \BIC{}
      \DP
\end{center}
\begin{center}
      \AXC{$\Theta_0 \subset \Theta$ ~~~~ $\vdash_{\Theta}\gamma'$ ~~~~ $\vdash_{\Theta}k\notin dom(\gamma') ~~~~ \vdash_{\Theta}\tau ~~~~\vdash_{\Theta}e\rightsquigarrow i\Leftarrow Keyword$}
      \UIC{$\vdash_{\Theta} \gamma';k[\mathbf{bk(\tau)},e]$}
      \DP
\end{center}


\begin{flushleft}\fbox{$\vdash_{\Theta}\kappa\rightsquigarrow\gamma$}\end{flushleft}
\begin{center}
      \AXC{$\Theta_0 \subset \Theta$ ~~~~ $\vdash_{\Theta}\kappa\rightsquigarrow\gamma$ ~~~~ $k\notin dom(\gamma)$ ~~~~ $\vdash_{\Theta} e_k\rightsquigarrow i_k \Leftarrow Keyword$} \RightLabel{~~~(white-box-keyword)}
      \UIC{$\vdash_{\Theta} \kappa;k[\mathbf{wk},e_{k}] \rightsquigarrow \gamma;k[\mathbf{wk}, i_k]$}
      \DP
\end{center}

\begin{center}
      \AXC{$\Theta_0 \subset \Theta$ ~~~~ $\vdash_{\Theta}\kappa\rightsquigarrow\gamma$ ~~~~ $k\notin dom(\gamma)$ ~~~~ $\vdash_{\Theta}\tau$ ~~~~ $\vdash_{\Theta}e_k\rightsquigarrow i_k \Leftarrow Keyword$} \RightLabel{~~~(black-box-keyword)}
      \UIC{$\vdash_{\Theta}\kappa;k[\mathbf{bk}(\tau),e_{k}] \rightsquigarrow \gamma;k[\mathbf{bk}(\tau),i_k]$}
      \DP
\end{center}
\label{typechecking-elaboration}
\caption{Typechecking and elaboration of programs}
\end{figure*}
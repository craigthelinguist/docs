\begin{figure*}[ht]
\flyingbox{$\rho \sim \Delta\sim \Theta\rightsquigarrow i:\tau$}
\vspace{-25px}
\begin{center}
\AXC{$\vdash_{\Theta_{0}}\eta \sim \Delta$ ~~~~ $\vdash_{\Theta_{0}}^{\Delta}\theta\sim\Theta$ ~~~~ $\emptyset\vdash_{\Theta_0\Theta}^{\Delta}e\rightsquigarrow i\Rightarrow \tau$}      \RightLabel{(compile)}
\UIC{$\eta;\theta;e\sim\Delta\sim\Theta\rightsquigarrow i:\tau$}
\DP
\end{center}
\vspace{3pt}

\flyingbox{$\vdash_{\Theta}\eta\sim\Delta$}
\vspace{-25px}
\begin{center}
\AXC{}\RightLabel{~(tykw-n)}
\UIC{$\vdash_{\Theta} \emptyset\sim\emptyset$}
\AXC{$\Theta_0 \subset\Theta$ ~~~~ $\vdash_\Theta \eta\sim\Delta$ ~~~~ $k\notin dom(\Delta)$ ~~~~ $\vdash_{\Theta}e\rightsquigarrow i\Leftarrow \mathbf{named}[TypeKw]$ ~~~~ $\vdash_{\Theta}\tau$}
\RightLabel{~(tykw-c)}
\UIC{$\vdash_{\Theta} \eta;k[e, \tau] \sim \Delta;k[i, \tau]$}
\noLine
\BIC{}
\DP
\end{center}
\vspace{3pt}

\flyingbox{$\vdash_{\Theta}^{\Delta}\theta\sim \Theta$}
\vspace{-25px}
\begin{center}
\AXC{}\RightLabel{~ (ctx-empty)}
\UIC{${\vdash_{\Theta}} \emptyset \sim \emptyset$}
\DP
\end{center}
\vspace{3pt}

\begin{center}
\AXC{$\Theta_{0}\subset\Theta$ ~~~~ $\vdash_{\Theta}\theta' \sim \Theta'$ ~~~~ $T\notin {dom}(\Theta)$ ~~~~ $T\notin dom(\Theta')$}
\noLine
\UIC{$\vdash_{\Theta\Theta',T[?,?,?]}\tau$ ~~~~ $\emptyset\vdash_{\Theta\Theta',T[\tau,?,?]}^{\Delta}e\rightsquigarrow i_m\Rightarrow\tau_m$ ~~~~ $\vdash^{\Delta}_{\Theta\Theta',T[\tau,i_m:\tau_m,?]}\kappa\rightsquigarrow\dot\kappa$}\RightLabel{~ (ctx-explicit-type)}
\UIC{${\vdash^{\Delta}_{\Theta}} \theta';T[\mathbf{explicit},\tau,e_m,\kappa] \sim \Theta',T[\tau,i_m:\tau_m,\dot\kappa]$}
\DP
\end{center}
\vspace{3pt}

\begin{center}
\AXC{$\Theta_0\subset\Theta$ ~~~~ $\vdash_{\Theta}\theta' \sim \Theta'$ ~~~~ $T\notin {dom}(\Theta)$ ~~~~ $T\notin dom(\Theta')$ ~~~~ $k[i,\tau_m]\in\Delta$}
\noLine
\UIC{$\texttt{parsestream}(body)=i_{ps}$ ~~~~ $\mathbf{iap}(\mathbf{iprj}[parse](i_k);i_{ps})\Downarrow(i_{type},i_{m},i_{kw})$} 
\noLine
\UIC{$i_{type}\uparrow\tau$ ~~~~ $\vdash_{\Theta\Theta',T[?,?,?]}^{\Delta}\tau$ ~~~~ $\emptyset\vdash_{\Theta\Theta',T[\tau,?,?]}e_m\rightsquigarrow i_m' \Rightarrow \mathbf{arrow}[\tau_m, \tau'_m]$ ~~~~ $\mathbf{iap}(i_m';i_m)\Downarrow i''_m$}
\noLine
\UIC{$i_{kw}\uparrow\dot{\kappa}$ ~~~~ $\myvdash \dot\kappa$~~~~ $\vdash^{\Delta}_{\Theta\Theta',T[\tau,i'_m:\tau'_m,?]}\kappa\rightsquigarrow\dot{\kappa}'$ ~~~~ $dom(\dot{\kappa})\cap dom(\dot{\kappa}')=\emptyset$}\RightLabel{~ (ctx-typekw-type)}
\UIC{$\myvdash \theta';T[\mathbf{tykw},k,body,e_m,\kappa] \sim \Theta',T[\tau,i''_m:\tau'_m,\dot{\kappa}\dot{\kappa}']$}
\DP
\end{center}
\vspace{3pt}

\flyingbox{$\myvdash \kappa\rightsquigarrow \dot\kappa$}
\vspace{-25px}
\begin{center}
\AXC{$\Theta_0\subset \Theta$ ~~~~ $\myvdash \kappa\rightsquigarrow\dot\kappa$ ~~~~ $k\notin dom(\dot\kappa)$ ~~~~ $\vdash_{\Theta} \tau$ ~~~~ $\emptyset\myvdash e_{k}\rightsquigarrow i_{k}\Leftarrow \mathbf{named}[ExprKw]$}	\RightLabel{(expkw-bk)}
\UIC{$\myvdash\kappa;k[\mathbf{bk}(\tau),e_k]\rightsquigarrow \dot\kappa;k[\mathbf{bk}(\tau),i_k]$}
\DP
\end{center}
\vspace{3pt}

\begin{center}
\AXC{$\Theta_0\subset \Theta$ ~~~~ $\myvdash \kappa\rightsquigarrow\dot\kappa$ ~~~~ $k\notin dom(\dot\kappa)$ ~~~~ $\emptyset\myvdash e_{k}\rightsquigarrow i_{k}\Leftarrow \mathbf{named}[ExprKw]$}								\RightLabel{(expkw-wk)}
\UIC{$\myvdash\kappa;k[\mathbf{wk},e_k]\rightsquigarrow \dot\kappa;k[\mathbf{wk},i_k]$}
\DP
\end{center}
\caption{Typechecking and elaboration of programs}
\label{typechecking-elaboration}
\end{figure*}

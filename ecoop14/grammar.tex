% !TEX root = ecoop14.tex
\section{Grammar in Adams' Formalism}
\label{s:grammar}

\begin{lstlisting}[mathescape]
|'var'| $\rightarrow$ 'var'$^=$
|'def'| $\rightarrow$ 'def'$^=$
|'type'| $\rightarrow$ 'type'$^=$
|':'| $\rightarrow$ ':'$^=$
|'('| $\rightarrow$ '('$^=$
|')'| $\rightarrow$ ')'$^=$
|'='| $\rightarrow$ '='$^=$
|'.'| $\rightarrow$ '.'$^=$
|'->'| $\rightarrow$ '->'$^=$
|','| $\rightarrow$ ','$^=$
|'metaobject'| $\rightarrow$ 'metaobject'$^=$
|'fn'| $\rightarrow$ 'fn'$^=$
|'=>'| $\rightarrow$ '=>'$^=$
|'new'| $\rightarrow$ 'new'$^=$
|'~'| $\rightarrow$ '~'$^=$
|'&'| $\rightarrow$ '&'$^=$
|'#'| $\rightarrow$ '#'$^=$
|'<'| $\rightarrow$ '<'$^=$
|'>'| $\rightarrow$ '>'$^=$
|';'| $\rightarrow$ ';'$^=$

|p| $\rightarrow$ $\varepsilon$
|p| $\rightarrow$ |decl|$^=$

|decl| $\rightarrow$ |'var'|$^=$ ID$^\geq$ ':'$^\geq$ type$^\geq$ '='$^\geq$ body$^>$
|decl| $\rightarrow$ |'var'|$^=$ ID$^\geq$ ':'$^\geq$ type$^\geq$ '='$^\geq$ body$^>$ decl$^=$
|decl| $\rightarrow$ |'def'|$^=$ ID$^\geq$ '('$^\geq$ typedargslist$^\geq$ ')'$^\geq$ '='$^\geq$ body$^>$
|decl| $\rightarrow$ |'def'|$^=$ ID$^\geq$ '('$^\geq$ typedargslist$^\geq$ ')'$^\geq$ '='$^\geq$ body$^>$ decl$^=$
|decl| $\rightarrow$ |'type'|$^=$ ID$^\geq$ '='$^\geq$ typebody$^>$
|decl| $\rightarrow$ |'type'|$^=$ ID$^\geq$ '='$^\geq$ typebody$^>$ decl$^=$

|body| $\rightarrow$ |stmt|$^=$
|body| $\rightarrow$ NEWLINE$^\geq$ stmt$^=$

|typebody| $\rightarrow$ |type|$^=$
|typebody| $\rightarrow$ NEWLINE$^\geq$ declintype$^=$

|declintype| $\rightarrow$ |'def'|$^=$ ID$^\geq$ '('$^\geq$ typedargslist$^\geq$ ')'$^\geq$ '='$^\geq$ body$^>$
|declintype| $\rightarrow$ |'def'|$^=$ ID$^\geq$ '('$^\geq$ typedargslist$^\geq$ ')'$^\geq$ '='$^\geq$ body$^>$ declintype$^=$
|declintype| $\rightarrow$ propdecl$^=$ // FIX!
|declintype| $\rightarrow$ propdecl$^=$ declintype$^=$
|declintype| $\rightarrow$ |'type'|$^=$ ID$^\geq$ '='$^\geq$ typebody$^>$
|declintype| $\rightarrow$ |'type'|$^=$ ID$^\geq$ '='$^\geq$ typebody$^>$ declintype$^=$
|declintype| $\rightarrow$ |'metaobject'|$^=$ '='$^\geq$ body$^>$
|declintype| $\rightarrow$ |'metaobject'|$^=$ '='$^\geq$ body$^>$ declintype$^=$
|declintype| $\rightarrow$ |'metaobject'|$^=$ ':'$^\geq$ type$^\geq$ '='$^\geq$ body$^>$
|declintype| $\rightarrow$ |'metaobject'|$^=$ ':'$^\geq$ type$^\geq$ '='$^\geq$ body$^>$ declintype$^=$

|stmt| $\rightarrow$ |exp|$^=$ NEWLINE$^\geq$
|stmt| $\rightarrow$ |exp|$^=$ NEWLINE$^\geq$ stmt$^=$
|stmt| $\rightarrow$ |expwdsl|$^=$ dsltilde$^>$
|stmt| $\rightarrow$ |expwdsl|$^=$ dsltilde$^>$ stmt$^=$
|stmt| $\rightarrow$ |ID|$^=$ '='$^\geq$ exp$^\geq$ NEWLINE$^\geq$
|stmt| $\rightarrow$ |ID|$^=$ '='$^\geq$ exp$^\geq$ NEWLINE$^\geq$ stmt$^=$
|stmt| $\rightarrow$ |ID|$^=$ '='$^\geq$ expwdsl$^\geq$ dsltilde$^>$
|stmt| $\rightarrow$ |ID|$^=$ '='$^\geq$ expwdsl$^\geq$ dsltilde$^>$ stmt$^=$
|stmt| $\rightarrow$ |exp|$^=$ '.'$^\geq$ ID$^\geq$ '='$^\geq$ exp$^\geq$ NEWLINE$^\geq$
|stmt| $\rightarrow$ |exp|$^=$ '.'$^\geq$ ID$^\geq$ '='$^\geq$ exp$^\geq$ NEWLINE$^\geq$ stmt$^=$
|stmt| $\rightarrow$ |exp|$^=$ '.'$^\geq$ ID$^\geq$ '='$^\geq$ expwdsl$^\geq$ dsltilde$^>$
|stmt| $\rightarrow$ |exp|$^=$ '.'$^\geq$ ID$^\geq$ '='$^\geq$ expwdsl$^\geq$ dsltilde$^>$ stmt$^=$
|stmt| $\rightarrow$ |expwdsl|$^=$ '.'$^\geq$ ID$^\geq$ '='$^\geq$ exp$^\geq$ dsltilde$^>$
|stmt| $\rightarrow$ |expwdsl|$^=$ '.'$^\geq$ ID$^\geq$ '='$^\geq$ exp$^\geq$ dsltilde$^>$ stmt$^=$
|stmt| $\rightarrow$ |'def'|$^=$ ID$^\geq$ '('$^\geq$ typedargslist$^\geq$ ')'$^\geq$ '='$^\geq$ body$^>$
|stmt| $\rightarrow$ |'def'|$^=$ ID$^\geq$ '('$^\geq$ typedargslist$^\geq$ ')'$^\geq$ '='$^\geq$ body$^>$ stmt$^=$
|stmt| $\rightarrow$ |'var'|$^=$ ID$^\geq$ :$^\geq$ type$^\geq$ '='$^\geq$ body$^>$
|stmt| $\rightarrow$ |'var'|$^=$ ID$^\geq$ :$^\geq$ type$^\geq$ '='$^\geq$ body$^>$ stmt$^=$

|exp| $\rightarrow$ |ID|$^=$
|exp| $\rightarrow$ |'fn'|$^=$ ID$^\geq$ ':'$^\geq$ type$^\geq$ '=>'$^\geq$ exp$^\geq$
|exp| $\rightarrow$ |exp|$^=$ '('$^\geq$ arglist$^\geq$ ')'$^\geq$
|exp| $\rightarrow$ |exp|$^=$ '.'$^\geq$ ID$^\geq$
|exp| $\rightarrow$ |exp|$^=$ ':'$^\geq$ type$^\geq$
|exp| $\rightarrow$ |'('|$^=$ type$^\geq$ ')'$^\geq$ exp$^\geq$
|exp| $\rightarrow$ |'new'|$^=$ newspec$^>$
|exp| $\rightarrow$ |type|$^=$ 'metaobject'$^\geq$
|exp| $\rightarrow$ dslinline$^=$

|expwdsl| $\rightarrow$ |'~'|$^=$
|expwdsl| $\rightarrow$ |expwdsl|$^=$ '.'$^\geq$ ID$^\geq$
|expwdsl| $\rightarrow$ |expwdsl|$^=$ '('$^\geq$ arglist$^\geq$ ')'$^\geq$
|expwdsl| $\rightarrow$ |exp|$^=$ '('$^\geq$ arglistwdsl$^\geq$ ')'$^\geq$
|expwdsl| $\rightarrow$ |expwdsl|$^=$ ':'$^\geq$ type$^\geq$
|expwdsl| $\rightarrow$ |'('|$^=$ type$^\geq$ ')'$^\geq$ expwdsl$^\geq$
|expwdsl| $\rightarrow$ |'fn'|$^=$ ID$^\geq$ ':'$^\geq$ type$^\geq$ '=>'$^\geq$ expwdsl$^\geq$
        
|type| $\rightarrow$ |ID|$^=$
|type| $\rightarrow$ |type|$^=$ '->'$^\geq$ type$^\geq$
|type| $\rightarrow$ |type|$^=$ '.'$^\geq$ type$^\geq$

|arglist| $\rightarrow$ $\varepsilon$
|arglist| $\rightarrow$ |exp|$^=$
|arglist| $\rightarrow$ |exp|$^=$ ','$^\geq$ arglist$^\geq$

|arglistwdsl| $\rightarrow$ $\varepsilon$
|arglistwdsl| $\rightarrow$ |expwdsl|$^=$
|arglistwdsl| $\rightarrow$ |expwdsl|$^=$ ','$^\geq$ arglist$^\geq$
|arglistwdsl| $\rightarrow$ |arglist|$^=$ ','$^\geq$ expwdsl$^\geq$
|arglistwdsl| $\rightarrow$ |arglist|$^=$ ','$^\geq$ expwdsl$^\geq$ ','$^\geq$ arglist$^\geq$

|typedargslist| $\rightarrow$ $\varepsilon$
|typedargslist| $\rightarrow$ |ID|$^=$ ':'$^\geq$ type$^\geq$
|typedargslist| $\rightarrow$ |ID|$^=$ ':'$^\geq$ type$^\geq$ ','$^\geq$ typedargslist$^\geq$

|newspec| $\rightarrow$ $\varepsilon$
|newspec| $\rightarrow$ NEWLINE$^\geq$ decl$^=$

|dsltilde| $\rightarrow$ NEWLINE$^\geq$ dsltildebody$^=$

|dsltildebody| $\rightarrow$ |DSL|$^=$

|dslinline| $\rightarrow$ |'`'|$^=$ dsl$^\geq$ '`'$^\geq$
|dslinline| $\rightarrow$ |'''|$^=$ dsl$^\geq$ '''$^\geq$
|dslinline| $\rightarrow$ |'"'|$^=$ dsl$^\geq$ '"'$^\geq$
|dslinline| $\rightarrow$ |'/'|$^=$ dsl$^\geq$ '/'$^\geq$
|dslinline| $\rightarrow$ |'\'|$^=$ dsl$^\geq$ '\'$^\geq$
|dslinline| $\rightarrow$ |'{'|$^=$ dsl$^\geq$ '}'$^\geq$
|dslinline| $\rightarrow$ |'['|$^=$ dsl$^\geq$ ']'$^\geq$
|dslinline| $\rightarrow$ |'<'|$^=$ dsl$^\geq$ '>'$^\geq$
|dslinline| $\rightarrow$ |'&'|$^=$ dsl$^\geq$ ';'$^\geq$
|dslinline| $\rightarrow$ |'#'|$^=$ dsl$^\geq$ ' '$^\geq$
|dslinline| $\rightarrow$ |'+'|$^=$ dsl$^\geq$ ' '$^\geq$
|dslinline| $\rightarrow$ |'-'|$^=$ dsl$^\geq$ ' '$^\geq$
|dslinline| $\rightarrow$ |'+'|$^=$ dsl$^\geq$ '.'$^\geq$ dsl$^\geq$
|dslinline| $\rightarrow$ |'-'|$^=$ dsl$^\geq$ '.'$^\geq$ dsl$^\geq$
|dslinline| $\rightarrow$ |dsl|$^=$ '.'$^\geq$ dsl$^\geq$

|dsl| $\rightarrow$ $\varepsilon$
|dsl| $\rightarrow$ |DSL|$^=$

|propdecl| $\rightarrow$ ...
\end{lstlisting}
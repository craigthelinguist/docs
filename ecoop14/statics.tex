% !TEX root = ecoop14.tex
\section{Statics}

\begin{figure}
\centering
\[
\begin{array}{lll}
\rho & \bnfdef & \keyw{objtype}~ t~ = \{ \overline{\omega}, \keyw{metaobject}=e \}; \rho \\
     & \bnfalt & \keyw{casetype}~ t~ = \{ \overline{\chi}, \keyw{metaobject}=e \}; \rho\\
     & \bnfalt & e\\
     \\[1ex]
\chi & \bnfdef & C~\keyw{of}~\tau\\
\\[1ex]
e    & \bnfdef & x \\
     & \bnfalt & \boldsymbol\lambda x{:}\tau . e \\ %
     & \bnfalt & e(e) \\
     & \bnfalt & t.C(e) \\
     & \bnfalt & \keyw{case}~e~\keyw{of}~\{ \overline{c} \} \\
     & \bnfalt & \keyw{new}~ \{ \overline{d} \}\\
     & \bnfalt & e.f \\
%     & \bnfalt & e.f = e \\
     & \bnfalt & e.m \\
     & \bnfalt & e : \tau\\
     & \bnfalt & \tau.\keyw{metaobject}\\
     & \bnfalt & \lfloor dsl \rfloor \\
\\[1ex]
c    & \bnfdef & C(x) \Rightarrow e\\
	 \\[1ex]
d    & \bnfdef & \keyw{val}~ f:\tau = e \\
     & \bnfalt & \keyw{def}~ m:\tau = e 
%\\[1ex]	 
\end{array}
\begin{array}{lll}
~~~~
\end{array}
\begin{array}{lll}
\tau & \bnfdef & t\\
     & \bnfalt & \tau \rightarrow \tau \\
\\[1ex]

\omega   & \bnfdef & \keyw{val}~ f:\tau\\
         & \bnfalt & \keyw{def}~ m:\tau \\
\\[1ex]
\end{array}
\]
\caption{Featherweight Wyvern Syntax}
\label{fig:core2-syntax}
\end{figure}


\begin{figure}
\centering
\[
\begin{array}{c}

\infer[\textit{T-varx}]
	{\Delta,\Gamma \vdash x\uparrow\tau } 
	{x:\tau \in \Gamma & \tau= \{...\} \in \Delta}\\[3ex]

\infer[\textit{T-abs}]
	{\Delta; \Gamma \vdash  \boldsymbol\lambda x{:}\tau . e \uparrow \tau \rightarrow \tau_1} 
	{\Delta; (\Gamma, x:\tau) \vdash e\uparrow\tau_1 }\\[3ex]

\infer[\textit{T-appl}]
	{\Delta; \Gamma \vdash  e(e_1) \uparrow\tau_2} 
	{\Delta; \Gamma \vdash e \uparrow \tau_1 \rightarrow \tau_2 & \Gamma \vdash e_1 \uparrow \tau_1}\\[3ex]

\infer[\textit{T-new}]
	{\Delta; \Gamma \vdash \keyw{new}~\sigma \{ \overline{d} \} \uparrow \{ \overline{\tau_d} \}}
	{\Delta; \Gamma; \sigma \vdash \overline{d} \uparrow \overline{\sigma_d} & \sigma = \{ \overline{\sigma_d} \} & \overline{\tau_d} \subseteq \overline{\sigma_d}} \\[3ex]

\infer[\textit{T-field}]
	{\Delta; \Gamma \vdash  e.f \uparrow \tau_1} 
	{\Delta; \Gamma \vdash e:\sigma & \sigma= \{\keyw{var}~ f \uparrow \tau_1,... \} }\\[3ex]

\infer[\textit{T-assign }]
	{\Delta; \Gamma \vdash  e.f=e_2 \uparrow \tau_1} 
	{\Delta; \Gamma \vdash e \uparrow \sigma & \sigma= \{\keyw{var}~ f:\tau_1=e_1,... \} & \Delta; \Gamma\vdash e_2 \uparrow\tau_1 }\\[3ex]

\infer[\textit{T-meth2 }]
	{\Delta; \Gamma \vdash  e.m \uparrow\tau_1} 
	{\Delta; \Gamma \vdash e \uparrow\tau & \tau=\{...\keyw{meth}~ m:\tau_1=e_1,... \} }\\[3ex]

\infer[\textit{DT-var}]
	{\Delta; \Gamma; \sigma \vdash \keyw{var}~ f:\tau = e \uparrow \keyw{var}~ f:\tau; d }
	{\Delta; \Gamma \vdash e \uparrow \tau & \Delta; \Gamma \vdash d} \\[3ex]
	
\infer[\textit{DT-meth}]
	{\Delta; \Gamma; \sigma \vdash \keyw{meth}~ m:\tau = e \uparrow \keyw{meth}~ m:\tau; d }
	{\Delta; (\Gamma, \textit{this}:\sigma) \vdash e  \uparrow \tau & \Delta; \Gamma \vdash d } \\[3ex]

\infer[\textit{DT-type}]
	{\Delta; \Gamma \vdash  \keyw{type}~ t~=\{\overline{\tau_d}, \keyw{metaobject}=e\}; d} 
	{\Delta; \Gamma \vdash e \uparrow\tau ~~~~~ \Delta; \Gamma; t:\{\overline{\tau_d},\tau\} \vdash d ~~~~~ \tau: \{\overline{\tau_d}\}  }\\[3ex]

\infer[\textit{DT-getmetaobject}]
        {\Delta; \Gamma \vdash e \downarrow \tau   }
	{\Delta; \Gamma \vdash  \keyw{type}~ t~=\{\overline{\tau_d}, \keyw{metaobject}=e\} \uparrow \{\overline{\tau_d},\tau\}} \\[3ex]
	

\infer[\textit{DT-typeabbrev}]
	{\Delta; \Gamma \vdash  \keyw{type}~ t~=\{\tau\}; d} 
	{\Delta; \Gamma \vdash [\tau/t]d }\\[3ex]


\infer[\textit{Type-meth}]
	{\Delta; \Gamma \vdash  t.m \uparrow\tau} 
	{t : \{\overline{\tau_d}, t1\} \in \Delta ~~~~~ t1  \uparrow \{\overline{\tau'_d},\_\} \in \Delta ~~~~~ \keyw{meth}:\tau \in \overline{\tau'_d}   }\\[3ex]
	

\end{array}
\]
\caption{Static Semantics Rules Core 2}
\end{figure}
